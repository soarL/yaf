<?php use custody\Type;?>
<?php $this->display('header.html');?>
<div class="row">
    <div class="col-xs-12">
        <div class="box">
            <div class="box-header">
                <h3 class="box-title">代偿列表</h3>
                <div class="box-tools pull-right">
                    <?php $excelUrl = $queries->getUrl(['excel'=>1]);?>
                    <a class="btn btn-box-tool" data-toggle="tooltip" data-original-title="Excel下载" href="<?=$excelUrl;?>">
                    <i class="fa fa-file-excel-o text-red"></i></a>
                </div>
            </div>
            <div class="box-body pb-0">
                <div class="row">
                    <div class="col-sm-12">
                        <form action="" class="table-search-form clearfix">
                            <div class="form-group">
                                <label class="control-label">查询</label>
                                <?php $searchType = $queries->searchType;?>
                                <div class="select-wrap">
                                    <select class="form-control input-sm" name="searchType">
                                        <option value="oddNumber" <?php if($searchType=='oddNumber'):?>selected<?php endif;?>>标的号</option>
                                        <option value="batchNo" <?php if($searchType=='batchNo'):?>selected<?php endif;?>>批次号</option>
                                        <option value="batchNo" <?php if($searchType=='orgBatchNo'):?>selected<?php endif;?>>原批次号</option>
                                    </select>
                                </div>
                                <input type="text" class="form-control input-sm inline-input" name="searchContent" placeholder="查询内容" value="<?=$queries->searchContent?>">
                            </div>
                            <div class="form-group">
                                <label class="control-label time-label">交易时间</label>
                                <div class="input-group time-group">
                                    <input type="text" class="form-control input-sm timepicker" data-allow-input="true" name="beginTime" value="<?=$queries->beginTime?>">
                                    <div class="input-group-btn">
                                        <button type="button" class="btn btn-sm">至</button>
                                    </div>
                                    <input type="text" class="form-control input-sm timepicker" data-allow-input="true" name="endTime" value="<?=$queries->endTime?>">
                                </div>
                            </div>
                            <button type="submit" class="btn btn-sm btn-info">搜索</button>
                        </form>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <table class="table table-hover mb-0">
                            <tr>
                                <th>批次号</th>
                                <th>标的-期数</th>
                                <th>原批次号</th>
                                <th class="visible-lg">添加时间</th>
                                <th class="visible-lg">发送时间</th>
                                <th class="visible-lg">结果</th>
                                <th class="visible-lg">状态</th>
                                <th>操作</th>
                            </tr>
                            <?php foreach ($records as $record):?>
                            <tr data-org-batch="<?=$record->orgBatchNo?>">
                                <td><?=$record->batchNo?></td>
                                <td><?=$record->oddNumber.'-'.$record->period?></td>
                                <td><?=$record->orgBatchNo?></td>
                                <td class="visible-lg">
                                <?=_date('n/j H:i:s', $record->addTime)?>
                                </td>
                                <td class="visible-lg">
                                    <?=_date('n/j H:i:s', $record->sendTime)?>
                                </td>
                                <td class="visible-lg">
                                    <span class="label label-primary" data-toggle="tooltip" data-original-title="<?=$record->getResult()?>">
                                        <?=_date('n/j H:i:s', $record->returnTime)?>
                                    </span>
                                </td>
                                <td class="visible-lg">
                                    <?php if($record->status==1):?>
                                    <span class="label label-success">处理成功</span>
                                    <?php elseif($record->status==2):?>
                                    <span class="label label-danger">处理失败</span>
                                    <?php elseif($record->status==-1):?>
                                    <span class="label label-primary">处理中</span>
                                    <?php else:?>
                                    <span class="label label-warning">未处理</span>
                                    <?php endif;?>
                                </td>
                                <td>
                                    <a class="btn btn-ssm btn-info btn-repay" href="javascript:;">
                                        还垫付款
                                    </a>
                                </td>
                            </tr>
                            <?php endforeach;?>
                        </table>
                    </div>
                </div>
            </div>
            <div class="box-footer clearfix">
                <?=$records->render()?>
            </div>
        </div>
    </div>
</div>
<?php $this->display('footer.html');?>